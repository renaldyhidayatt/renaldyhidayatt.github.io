---
title: "Distributed Modular Monolith Payment Gateway"
excerpt: "A Distributed Modular Monolith Payment Gateway built with Go, gRPC, PostgreSQL, and Kafka with full observability stack."
date: "2025-08-18"
tags: [
  "golang", "grpc", "echo", "postgresql", "kafka", "docker", "docker-compose",
  "prometheus", "grafana", "opentelemetry", "jaeger", "redis", "kubernetes",
  "loki", "otel-collector", "zap", "sqlc", "goose", "swago", "zookeeper", "nginx", "node-exporter", "postman"
]
status: "development"
image: "/portofolio/distributed-modular-monolith-paymentgateway.png"
---

# üí≥ Distributed Modular Monolith Payment Gateway

Proyek ini adalah **Implementasi Distribute Modular Monolith Payment Gateway** dari **Sistem Gerbang Pembayaran**. Arsitektur ini dirancang untuk menyediakan **backend yang aman, dapat diskalakan, dan modular** untuk menangani transaksi keuangan, pembayaran merchant, operasi kartu, dan alur penyelesaian.

Tidak seperti monolit tradisional, sistem ini disusun menjadi **modul (layanan) yang terdefinisi dengan baik** seperti **Auth, Pengguna, Peran, Kartu, Saldo, Transaksi, Merchant, Transfer, Isi Ulang, Tarik Tunai**, dll. Setiap modul berkomunikasi secara internal melalui **gRPC** dan secara eksternal melalui **API Gateway (NGINX)**. Peristiwa dipublikasikan melalui **Kafka** untuk alur kerja asinkron yang digerakkan oleh peristiwa (misalnya, penyelesaian, notifikasi email, pembaruan saldo).

Di lapisan infrastruktur, sistem terintegrasi dengan:

*   **PostgreSQL** sebagai basis data relasional inti.
*   **Redis** untuk caching dan manajemen sesi waktu nyata.
*   **Kafka** (dengan Zookeeper) sebagai bus acara untuk pemrosesan asinkron.
*   **Layanan Email** untuk mengirim konfirmasi, penyelesaian, dan notifikasi transaksional.
*   **Tumpukan Observabilitas** (Prometheus, Grafana, Loki, Jaeger, OpenTelemetry) untuk pemantauan, pencatatan, dan pelacakan di seluruh ekosistem.

Penerapan dapat dijalankan di:

*   **Docker Compose** untuk pengembangan dan pengujian lokal yang lengkap.
*   **Kubernetes** untuk lingkungan tingkat produksi dengan penskalaan otomatis dan ketahanan.

---

## üéØ Fitur Utama

*   **üîê Manajemen Otentikasi & Peran**
    *   Otentikasi pengguna yang aman dengan JWT.
    *   Kontrol akses berbasis peran (admin, merchant, pelanggan, sistem).
    *   Izin disimpan di Redis untuk pencarian cepat.

*   **üí≥ Manajemen Kartu & Saldo**
    *   Pendaftaran kartu dan manajemen siklus hidup.
    *   Pembaruan saldo otomatis yang dipicu oleh peristiwa kartu.
    *   Layanan saldo memastikan status akun yang konsisten.

*   **üè¶ Pemrosesan Transaksi**
    *   Dukungan penuh untuk **transaksi pembayaran**, termasuk pembuatan, penyelesaian, pengembalian dana.
    *   Peristiwa transaksi dipublikasikan ke Kafka untuk layanan hilir.
    *   Konfirmasi transaksi waktu nyata dikirim melalui email.

*   **üì§ Transfer, Isi Ulang, dan Penarikan**
    *   Layanan transfer untuk pembayaran peer-to-peer atau merchant.
    *   Layanan isi ulang untuk mendanai kartu atau dompet.
    *   Layanan penarikan untuk pembayaran kepada merchant atau pelanggan.
    *   Setiap operasi menghasilkan konfirmasi email berbasis peristiwa.

*   **üõí Manajemen Merchant**
    *   Pendaftaran dan verifikasi merchant.
    *   Status dokumen dan peristiwa konfirmasi terintegrasi dengan Layanan Email.
    *   Alur penyelesaian terhubung ke layanan Transaksi dan Saldo.

*   **‚ö° Arsitektur Berbasis Peristiwa**
    *   Broker Kafka memastikan pemisahan antara modul inti.
    *   Notifikasi email, pemicu penyelesaian, dan pembaruan saldo digerakkan oleh peristiwa.
    *   Cache Redis menyimpan data yang sering diakses (izin, sesi, saldo).

*   **üìä Observabilitas & Pemantauan**
    *   Endpoint `/metrics` di semua layanan diekspos ke Prometheus.
    *   Log dikirim dengan Promtail ‚Üí Loki.
    *   Kesehatan sistem divisualisasikan melalui dasbor Grafana.
    *   Pelacakan ujung ke ujung dengan OpenTelemetry ‚Üí Jaeger.

---

## üèóÔ∏è Arsitektur Penerapan

### **1. Docker Compose (Pengembangan Lokal)**

*   Mengatur **API Gateway, Layanan Inti, Pesan (Kafka + Zookeeper), Basis Data (PostgreSQL), Redis, Layanan Email, dan tumpukan Observabilitas**.
*   Ideal untuk **pengujian integrasi** dan menjalankan sistem gerbang pembayaran penuh secara lokal.
*   Pengembang dapat memvalidasi alur transaksi ujung ke ujung (misalnya, kartu ‚Üí saldo ‚Üí transaksi ‚Üí email).

### **2. Kubernetes (Produksi)**

*   Setiap layanan inti berjalan di Pod-nya sendiri di dalam kluster.
*   Kafka, Redis, PostgreSQL diterapkan sebagai Pod infrastruktur yang tangguh.
*   Tugas migrasi memastikan skema basis data selalu terbaru.
*   Horizontal Pod Autoscalers (HPA) menskalakan layanan penting seperti **Transaksi**, **Saldo**, atau **Merchant** di bawah beban.
*   Komponen observabilitas diterapkan sebagai Pod/DaemonSet untuk **log, metrik, dan jejak**.
*   Alur yang digerakkan oleh peristiwa tetap terpisah, memastikan **throughput tinggi dan toleransi kesalahan** dalam operasi keuangan.

---

## üõ†Ô∏è Teknologi yang Digunakan
- üöÄ **gRPC** ‚Äî Menyediakan API berkinerja tinggi dan bertipe kuat.
- üì° **Kafka** ‚Äî Digunakan untuk mempublikasikan peristiwa terkait saldo (misalnya, setelah pembuatan kartu).
- üìà **Prometheus** ‚Äî Mengumpulkan metrik seperti jumlah permintaan dan latensi untuk setiap metode RPC.
- üõ∞Ô∏è **OpenTelemetry (OTel)** ‚Äî Memungkinkan pelacakan terdistribusi untuk observabilitas.
- ü¶´ **Go (Golang)** ‚Äî Bahasa implementasi.
- üåê **Echo** ‚Äî Kerangka kerja HTTP untuk Go.
- ü™µ **Zap Logger** ‚Äî Pencatatan terstruktur untuk debugging dan operasi.
- üì¶ **Sqlc** ‚Äî Generator kode SQL untuk Go.
- üß≥ **Goose** ‚Äî Alat migrasi basis data.
- üê≥ **Docker** ‚Äî Alat kontainerisasi.
- üß± **Docker Compose** ‚Äî Menyederhanakan kontainerisasi untuk lingkungan pengembangan dan produksi.
- üêò **PostgreSQL** ‚Äî Basis data relasional untuk menyimpan data pengguna.
- üìÉ **Swago** ‚Äî Generator dokumentasi API.
- üß≠ **Zookeeper** ‚Äî Manajemen konfigurasi terdistribusi.
- üîÄ **Nginx** ‚Äî Proksi terbalik untuk lalu lintas HTTP.
- üîç **Jaeger** ‚Äî Pelacakan terdistribusi untuk observabilitas.
- üìä **Grafana** ‚Äî Alat pemantauan dan visualisasi.
- üß™ **Postman** ‚Äî Klien API untuk menguji dan men-debug endpoint.
- ‚ò∏Ô∏è **Kubernetes** ‚Äî Platform orkestrasi kontainer untuk penerapan, penskalaan, dan manajemen.
- üß∞ **Redis** ‚Äî Penyimpanan nilai kunci dalam memori yang digunakan untuk caching dan akses data cepat.
- üì• **Loki** ‚Äî Sistem agregasi log untuk mengumpulkan dan menanyakan log.
- üì§ **Promtail** ‚Äî Agen pengiriman log yang mengirim log ke Loki.
- üîß **OTel Collector** ‚Äî Kolektor agnostik vendor untuk menerima, memproses, dan mengekspor data telemetri (metrik, jejak, log).
- üñ•Ô∏è **Node Exporter** ‚Äî Mengekspos metrik tingkat sistem (host) seperti CPU, memori, disk, dan statistik jaringan untuk Prometheus.


----

## Memulai

Ikuti petunjuk ini untuk menjalankan proyek di mesin lokal Anda untuk tujuan pengembangan dan pengujian.

### Prasyarat

Pastikan Anda telah menginstal alat-alat berikut:
- [Git](https://git-scm.com/)
- [Go](https://go.dev/) (versi 1.20+)
- [Docker](https://www.docker.com/)
- [Docker Compose](https://docs.docker.com/compose/)
- [Make](https://www.gnu.org/software/make/)

### 1. Klon Repositori

```sh
git clone https://github.com/MamangRust/monolith-payment-gateway-grpc.git
cd monolith-payment-gateway-grpc
```

### 2. Konfigurasi Lingkungan

Proyek ini menggunakan file lingkungan untuk konfigurasi. Anda perlu membuat file `.env` yang diperlukan.
*   Buat file `.env` di direktori root untuk pengaturan umum.
*   Buat file `docker.env` di `deployments/local/` untuk pengaturan khusus Docker.

Anda dapat menyalin file contoh jika ada, atau membuatnya dari awal.

### 3. Jalankan Aplikasi

Perintah berikut akan membangun image Docker, memulai semua layanan, dan menyiapkan basis data.

**1. Bangun image dan luncurkan layanan:**
Perintah ini membangun semua image layanan dan memulai seluruh infrastruktur (termasuk basis data, Kafka, dll.) menggunakan Docker Compose.

```sh
make build-up
```

**2. Jalankan Migrasi Basis Data:**
Setelah kontainer berjalan, terapkan migrasi skema basis data.

```sh
make migrate
```

**3. Isi Basis Data (Opsional):**
Untuk mengisi basis data dengan data awal untuk pengujian, jalankan seeder.

```sh
make seeder
```

Platform sekarang harus beroperasi penuh. Anda dapat memeriksa status kontainer yang berjalan dengan `make ps`.

### Menghentikan Aplikasi

Untuk menghentikan dan menghapus semua kontainer yang berjalan, gunakan perintah berikut:

```sh
make down
```


----

## Tinjauan Arsitektur

Platform Pembayaran Digital ini dirancang sebagai **sistem monolitik modular**. Meskipun logika bisnis diatur ke dalam layanan yang berbeda (misalnya, `user`, `transaction`, `card`), mereka dikembangkan dalam satu basis kode. Pendekatan ini menggabungkan kesederhanaan monolit dengan manfaat organisasi dari arsitektur berorientasi layanan.

Sistem ini dirancang untuk diterapkan menggunakan kontainerisasi, dengan kontainer terpisah untuk setiap layanan. Hal ini memungkinkan penskalaan dan manajemen komponen secara independen di lingkungan seperti produksi.

### Konsep Arsitektur Utama:

*   **API Gateway**: Satu titik masuk untuk semua permintaan klien. Ini merutekan lalu lintas ke layanan backend yang sesuai, menangani otentikasi, dan menyediakan API terpadu.
*   **gRPC for Inter-Service Communication**: gRPC berkinerja tinggi digunakan untuk komunikasi antara layanan internal, memastikan latensi rendah dan kontrak bertipe kuat.
*   **Pesan Asinkron dengan Kafka**: Kafka digunakan untuk komunikasi berbasis peristiwa, memisahkan layanan dan meningkatkan ketahanan. Misalnya, ketika kartu baru dibuat, sebuah pesan dipublikasikan ke topik Kafka, yang kemudian dikonsumsi oleh layanan `saldo` untuk memperbarui saldo.
*   **Observabilitas Terpusat**: Platform ini mengintegrasikan tumpukan observabilitas yang komprehensif:
    *   **Prometheus** untuk mengumpulkan metrik.
    *   **Jaeger** (melalui OpenTelemetry) untuk pelacakan terdistribusi.
    *   **Loki** dan **Promtail** untuk agregasi log.
    *   **Grafana** untuk visualisasi metrik, jejak, dan log.

### Arsitektur Penerapan

Platform ini dirancang untuk berjalan di lingkungan terkontainerisasi. Kami menyediakan konfigurasi untuk Docker Compose (untuk pengembangan lokal) dan Kubernetes (untuk pengaturan seperti produksi).

#### Lingkungan Docker

Pengaturan Docker menggunakan `docker-compose` untuk mengatur semua layanan, basis data, dan alat yang diperlukan untuk lingkungan pengembangan lokal yang lengkap.

[![](https://mermaid.ink/img/pako:eNqdV21v4jgQ_itRql11JWibkARI704qUFW9lm6PUPWuYT9MYidEDTFyTOle6X8_x3mHdA-aLyEzzzwejz2PzZvsEoRlU_ZCsnbnQJk0Hc0iiT9fvki_Nz6F--L-WroChtfwc6-QeOX4FJbzelDy3F1d3_1tV_ik09T2I8XgCM2ifdMaEoolC9OXwMXxYYkloXmkXeP5USY7tewphSgGlwUkyhEVwNCyh0BRg-fBsh9iTBs8E8uekBA3eMaWPcaUr03EGrwDyx5ACJHbFHph2RcrNm_wTCfZJLzGbKY80SlZrpYNvkfLfgzYHFFYb3kPWqUxjmPwg8iXvkoWIxR8fNhaFQQXEaoRJM8NeM9gH4uXNKDkGdNvlTk83djHT4Rb8bLumGAUxPaxeElDcOe46h0N7ON7EjOf75K_bqURMHAgLiAHzf-7wzfCCzhBGLAD26cWajFwn-2aSRK2St73lCwYBOFWfS5fl4QyTCt9yMVg15qEYzbHq7i03ZLnoPz6znA4JGGIXb4QpfmKggcRlIY_Afs582G7JYjdw3r6csEnbNnitbVPxwGvY9K7dvGrgtg3pVyphiSKsJCC_RITuia1239wIdm2DHcsDzuWifU5KTw40amVjLepat3lC45YvEm3z8coUXOB3WTrkGKHKVaIIxcm0s6lK8MOGnCZqzLig5XWIenR1DJJ8UJA7zFdBHFcZLupAscpsNBTXhIvoAuxBU5517BV3JR3GlbNYbBjmU4qhUhUtYFn-pBhhLQ2AB5Tf6GvH0LykT91Jkq_cYLRYK_Y6omYFhkDOn2kAcMbwbF_B-etlgyeKedewZXILO99x0zl_6uUyfmB-z-NTsZ8umkuRr61PqX5B-ezsxSnXJVp4PJ-3FbodMK_xhTT-wUmPzjEZEvJr50ewrcdWD1IGgHlt3DXTopkoF3rVkTDkVMzCVB-3uy_RNb0n9vruyvp2MER0G97hbkhxPEIexLCHqxCJnlBGJpHClawilsxS64f5lGv72getFwSEmoeuQgZnpY52-sAsbmpLF_Ptxj97JDJGdV-xykY-xpWkZ4zemce4vweiVh7jQN_zkyHhGib0U2UIKXrKB1V0wo61wHD6xZ0Oj5D7v_SBZFHIeNT-6qulnweOJ1eyYew0YPtcCI6Ip8eqPhML-LBwB1Q8njU9_r9neEXyb0gL04HevBBuR0POR4-T3dC-QeGnxN-lLLl1wrxkR23WfWrg9a7MClmzdtwKU1LVEPtXuCyQtRQqeq3SvlLJnsut2SfBkg2PQhj3JIX_LyD5Ft-S4JnMm-RBZ7JJv-JgD7P5Fn0zoOWEPEb70I2GV3xMEpW_rwgWS0Rn-ooAD5UCeE3NEyHZBUx2dR0QSGbb_KrbCqd_ommdg1F0bVu11D7LfmnbLZ17UTXNaNnaL1uV9UU1Xhvyf-KUZUTtaeccbNuKLrRVxXt_T_oJE8V?type=png)](https://mermaid.live/edit#pako:eNqdV21v4jgQ_itRql11JWibkARI704qUFW9lm6PUPWuYT9MYidEDTFyTOle6X8_x3mHdA-aLyEzzzwejz2PzZvsEoRlU_ZCsnbnQJk0Hc0iiT9fvki_Nz6F--L-WroChtfwc6-QeOX4FJbzelDy3F1d3_1tV_ik09T2I8XgCM2ifdMaEoolC9OXwMXxYYkloXmkXeP5USY7tewphSgGlwUkyhEVwNCyh0BRg-fBsh9iTBs8E8uekBA3eMaWPcaUr03EGrwDyx5ACJHbFHph2RcrNm_wTCfZJLzGbKY80SlZrpYNvkfLfgzYHFFYb3kPWqUxjmPwg8iXvkoWIxR8fNhaFQQXEaoRJM8NeM9gH4uXNKDkGdNvlTk83djHT4Rb8bLumGAUxPaxeElDcOe46h0N7ON7EjOf75K_bqURMHAgLiAHzf-7wzfCCzhBGLAD26cWajFwn-2aSRK2St73lCwYBOFWfS5fl4QyTCt9yMVg15qEYzbHq7i03ZLnoPz6znA4JGGIXb4QpfmKggcRlIY_Afs582G7JYjdw3r6csEnbNnitbVPxwGvY9K7dvGrgtg3pVyphiSKsJCC_RITuia1239wIdm2DHcsDzuWifU5KTw40amVjLepat3lC45YvEm3z8coUXOB3WTrkGKHKVaIIxcm0s6lK8MOGnCZqzLig5XWIenR1DJJ8UJA7zFdBHFcZLupAscpsNBTXhIvoAuxBU5517BV3JR3GlbNYbBjmU4qhUhUtYFn-pBhhLQ2AB5Tf6GvH0LykT91Jkq_cYLRYK_Y6omYFhkDOn2kAcMbwbF_B-etlgyeKedewZXILO99x0zl_6uUyfmB-z-NTsZ8umkuRr61PqX5B-ezsxSnXJVp4PJ-3FbodMK_xhTT-wUmPzjEZEvJr50ewrcdWD1IGgHlt3DXTopkoF3rVkTDkVMzCVB-3uy_RNb0n9vruyvp2MER0G97hbkhxPEIexLCHqxCJnlBGJpHClawilsxS64f5lGv72getFwSEmoeuQgZnpY52-sAsbmpLF_Ptxj97JDJGdV-xykY-xpWkZ4zemce4vweiVh7jQN_zkyHhGib0U2UIKXrKB1V0wo61wHD6xZ0Oj5D7v_SBZFHIeNT-6qulnweOJ1eyYew0YPtcCI6Ip8eqPhML-LBwB1Q8njU9_r9neEXyb0gL04HevBBuR0POR4-T3dC-QeGnxN-lLLl1wrxkR23WfWrg9a7MClmzdtwKU1LVEPtXuCyQtRQqeq3SvlLJnsut2SfBkg2PQhj3JIX_LyD5Ft-S4JnMm-RBZ7JJv-JgD7P5Fn0zoOWEPEb70I2GV3xMEpW_rwgWS0Rn-ooAD5UCeE3NEyHZBUx2dR0QSGbb_KrbCqd_ommdg1F0bVu11D7LfmnbLZ17UTXNaNnaL1uV9UU1Xhvyf-KUZUTtaeccbNuKLrRVxXt_T_oJE8V)

#### Lingkungan Kubernetes

Pengaturan Kubernetes menyediakan penerapan yang dapat diskalakan dan tangguh. Setiap layanan berjalan dalam set Pod-nya sendiri, dengan Horizontal Pod Autoscalers (HPA) untuk penskalaan otomatis berdasarkan beban.

[![](https://mermaid.ink/img/pako:eNq1WFlv4zYQ_iuCFlu02DiJZNmxlXaB-ECQzeX6QNqs94GSRrYQWRRIaZM0yX_vkDoi-UikFNWDDnK-jzNDzmE_qTZ1QDVV16f39pKwSJkO5oGC1-fPyh9br3z6fNYbjq-G0-FE6V_MJtPhuBKSx9aCkXCpnHf497l6HlvAAoiAK30_5hGwufpjHiSyKV1j61USOQsWDDhXvignozPllERwTx5rkeR6eQkV6nZFVsBDYoOZDUrdlMJ1dXp29ReKFlZVfs2U6dMgYtT3gf02nwffJ8B-ejagjiPq_ChRQeDUt7lPGSgpKf-YrTZSlA0VIw2eka6bO56g9Jj6-brCrgGEPn1cQRBtM01cMwGbIWs92FTApowEnNiRR4N66L5A9wlz6sEuBewSGIYDCtXTd5wr7Na2VfpoSsM4rAe8EbgbL1o6jNzXg_YEtEd8Etg1N_REIE_iaFkd9qEjfolhRBYYfMovyiSijCzgo0HtMrIe0ji0Ydk5ce-EoHwqPUbvMCOJ4I0wut3Yn8BOp9yeI-6WIgLCyqAxOJ7INfKp9Im9hIrIQQ9hI8ojTDaTPy-UAYmIRXgV-If24toSaYFYnu9Fj7gbxL772F5QSVTeDFok3zB1xOgqIp4vDE5f5YEjsKLBGy6Smzh8CCnDupJvajZQ7ahfYYUsUIjPMsN7SgiNIVpCzFP1k4-Ku3xB7zzEiUdFxHUEfl9UHRsDBqHXIQRT8AHXZY9KPlPN-lNGXBKIgEjfqsG-EVhIdyUv_1d28Lj9HwvgCinKJ1GMbNgzXOGREzlPvtQsKB4uJcqXqCvZu_KNWgKOj53uWPPL-x1Z1oBg3xGArJi8ElQ2Meizr1jf10dmGyPTjZH-pLqOWRM0_Iku45jW6yo7nog1n2UTMgKG28WFPyXfc5JOE8HZJDHpdWSaQIsdRaLGc5IpdkvJXU-XSM5CUVY6IGk5JFQ0HY2vWB6pklXXFNtLBS8TwbzNQCe4HlvJo3EgYjzm25Zbhw2oHcujt021ccEO0Y7sNmKWSsrmY6fYTSKVtxpbBaseg1LvqvyOPtxZ6t8hEw2rVGwUW77HlwfoS45eKe1pLiQLbOmY5FNjIM7BDfMinB_0qpvyGtNoRV6Eq4ALSAGtsWZSyDD3YH6AwPagWuwkMLHY7Xn1xcqFv2685v49EAXIszHYCkWwrNYbMkl_9LZM1htIC2XFDDa6ADm3DizW-K0Cr99yOquFQVahN0fXEKWinEiUhqRQWiyr59Lp3xdnV6fVtsEnnA_AVRxwSexHiuv5vvlJAw102OORaHTNT52uZbhkz6Y-ZeYn23HarpFONu49J1qaWvhwvMa4SMtOxqh3m1bO2DVAd1oZo3voOsjv4g_jxj14i2VkWtR31hnlmUnomlpTN4yczrZI2z3K6Vpw6Njv0slOP-XTu3pLf-VzidXsvPI50O6QdXjSm2bmER0OWzmetKFJtAzvdN1ud2N50VHkzmmSDtnhbst1LBeOC_t_Eob-Y0KEWRLLSZD1KbywRvbnRLYRxfUTV4rbcRkhPCLvpfHU1ORRmpFGiNuxuqcumOeopkt8DnvqCoswEd_qkwDMVTz1K5irJr46hN3N1XnwgqCQBPjjaKWaEYsRxmi8WOYkceig8gOPYEZ8FRHZjfVpHESqaXQlhWo-qQ-qqTW7-4Z-1Na0lnF01NZx8lE1Gy1jv9Uy2p220Tk60g1Nb7_sqf_IVbV9vaMd4nCrrbXaXV0zXv4FJxCauQ?type=png)](https://mermaid.live/edit#pako:eNq1WFlv4zYQ_iuCFlu02DiJZNmxlXaB-ECQzeX6QNqs94GSRrYQWRRIaZM0yX_vkDoi-UikFNWDDnK-jzNDzmE_qTZ1QDVV16f39pKwSJkO5oGC1-fPyh9br3z6fNYbjq-G0-FE6V_MJtPhuBKSx9aCkXCpnHf497l6HlvAAoiAK30_5hGwufpjHiSyKV1j61USOQsWDDhXvignozPllERwTx5rkeR6eQkV6nZFVsBDYoOZDUrdlMJ1dXp29ReKFlZVfs2U6dMgYtT3gf02nwffJ8B-ejagjiPq_ChRQeDUt7lPGSgpKf-YrTZSlA0VIw2eka6bO56g9Jj6-brCrgGEPn1cQRBtM01cMwGbIWs92FTApowEnNiRR4N66L5A9wlz6sEuBewSGIYDCtXTd5wr7Na2VfpoSsM4rAe8EbgbL1o6jNzXg_YEtEd8Etg1N_REIE_iaFkd9qEjfolhRBYYfMovyiSijCzgo0HtMrIe0ji0Ydk5ce-EoHwqPUbvMCOJ4I0wut3Yn8BOp9yeI-6WIgLCyqAxOJ7INfKp9Im9hIrIQQ9hI8ojTDaTPy-UAYmIRXgV-If24toSaYFYnu9Fj7gbxL772F5QSVTeDFok3zB1xOgqIp4vDE5f5YEjsKLBGy6Smzh8CCnDupJvajZQ7ahfYYUsUIjPMsN7SgiNIVpCzFP1k4-Ku3xB7zzEiUdFxHUEfl9UHRsDBqHXIQRT8AHXZY9KPlPN-lNGXBKIgEjfqsG-EVhIdyUv_1d28Lj9HwvgCinKJ1GMbNgzXOGREzlPvtQsKB4uJcqXqCvZu_KNWgKOj53uWPPL-x1Z1oBg3xGArJi8ElQ2Meizr1jf10dmGyPTjZH-pLqOWRM0_Iku45jW6yo7nog1n2UTMgKG28WFPyXfc5JOE8HZJDHpdWSaQIsdRaLGc5IpdkvJXU-XSM5CUVY6IGk5JFQ0HY2vWB6pklXXFNtLBS8TwbzNQCe4HlvJo3EgYjzm25Zbhw2oHcujt021ccEO0Y7sNmKWSsrmY6fYTSKVtxpbBaseg1LvqvyOPtxZ6t8hEw2rVGwUW77HlwfoS45eKe1pLiQLbOmY5FNjIM7BDfMinB_0qpvyGtNoRV6Eq4ALSAGtsWZSyDD3YH6AwPagWuwkMLHY7Xn1xcqFv2685v49EAXIszHYCkWwrNYbMkl_9LZM1htIC2XFDDa6ADm3DizW-K0Cr99yOquFQVahN0fXEKWinEiUhqRQWiyr59Lp3xdnV6fVtsEnnA_AVRxwSexHiuv5vvlJAw102OORaHTNT52uZbhkz6Y-ZeYn23HarpFONu49J1qaWvhwvMa4SMtOxqh3m1bO2DVAd1oZo3voOsjv4g_jxj14i2VkWtR31hnlmUnomlpTN4yczrZI2z3K6Vpw6Njv0slOP-XTu3pLf-VzidXsvPI50O6QdXjSm2bmER0OWzmetKFJtAzvdN1ud2N50VHkzmmSDtnhbst1LBeOC_t_Eob-Y0KEWRLLSZD1KbywRvbnRLYRxfUTV4rbcRkhPCLvpfHU1ORRmpFGiNuxuqcumOeopkt8DnvqCoswEd_qkwDMVTz1K5irJr46hN3N1XnwgqCQBPjjaKWaEYsRxmi8WOYkceig8gOPYEZ8FRHZjfVpHESqaXQlhWo-qQ-qqTW7-4Z-1Na0lnF01NZx8lE1Gy1jv9Uy2p220Tk60g1Nb7_sqf_IVbV9vaMd4nCrrbXaXV0zXv4FJxCauQ)

# Cara Menjalankan

## 1. Klon Repositori

```bash
git clone https://github.com/MamangRust/monolith-payment-gateway-grpc.git
cd monolith-payment-gateway-grpc
```

## 2. Menjalankan Secara Lokal dengan Docker Compose

Untuk menjalankan semua layanan secara lokal, Anda dapat menggunakan Docker Compose.

```bash
make build-up
```

Perintah ini akan membangun image untuk setiap layanan dan menjalankannya di latar belakang.

Untuk menghentikan semua layanan, jalankan perintah berikut:

```bash
make down
```

## 3. Menjalankan di Kubernetes

Untuk menjalankan semua layanan di Kubernetes, Anda dapat menggunakan Minikube.

```bash
make kube-start
make kube-up
```

Perintah ini akan memulai Minikube dan menerapkan semua konfigurasi Kubernetes yang terletak di direktori `deployments/kubernetes`.

Untuk menghentikan semua layanan di Kubernetes, jalankan perintah berikut:

```bash
make kube-down
```

## 4. Hasilkan Kode dari Protobuf

**Penting:** Proyek ini tidak menyertakan file `.proto`. Anda harus menambahkan file `.proto` Anda sendiri ke direktori `proto/`.

Setelah menambahkan file `.proto` Anda, jalankan perintah berikut untuk menghasilkan kode Go dari file `.proto` Anda:

```bash
make generate-proto
```

## 5. Hasilkan Kode dari SQL

Untuk menghasilkan kode Go dari file SQL, jalankan perintah berikut:

```bash
make generate-sql
```

## 6. Menjalankan Migrasi Basis Data

Untuk menjalankan migrasi basis data, jalankan perintah berikut:

```bash
make migrate
```

## 7. Menjalankan Seeder

Untuk mengisi basis data dengan data awal, jalankan perintah berikut:

```bash
make seeder
```

## 8. Menjalankan Tes

Untuk menjalankan tes pada layanan `auth`, jalankan perintah berikut:

```bash
make test-auth
```

## Makefile

Proyek ini dilengkapi dengan `Makefile` yang berisi berbagai perintah untuk memfasilitasi pengembangan. Berikut adalah beberapa perintah yang tersedia:

- `make migrate`: Jalankan migrasi basis data
- `make migrate-down`: Batalkan migrasi basis data
- `make generate-proto`: Hasilkan kode Go dari file `.proto`
- `make generate-sql`: Hasilkan kode Go dari file SQL
- `make generate-swagger`: Hasilkan dokumentasi Swagger
- `make seeder`: Isi basis data dengan data awal
- `make build-image`: Bangun image Docker untuk semua layanan
- `make image-load`: Muat image Docker ke Minikube
- `make image-delete`: Hapus image Docker dari Minikube
- `make ps`: Tampilkan status kontainer Docker
- `make up`: Jalankan semua layanan dengan Docker Compose
- `make down`: Hentikan semua layanan yang berjalan dengan Docker Compose
- `make build-up`: Bangun image dan jalankan semua layanan dengan Docker Compose
- `make kube-start`: Mulai Minikube
- `make kube-up`: Jalankan semua layanan di Kubernetes
- `make kube-down`: Hentikan semua layanan di Kubernetes
- `make kube-status`: Tampilkan status pod, layanan, PVC, dan pekerjaan di Kubernetes
- `make kube-tunnel`: Buat terowongan ke Minikube
- `make test-auth`: Jalankan tes pada layanan `auth`




## Screenshoot

### API Documentation
<img src="https://github.com/MamangRust/monolith-payment-gateway-grpc/raw/main/images/swagger.png" alt="hello-api-documentation" />


### ERD Documentation

<img src="https://github.com/MamangRust/monolith-payment-gateway-grpc/raw/main/images/Payment%20Gateway.png" alt="hello-erd-documentation" />


### Grafana Dashboard(Prometheus & OpenTelemetry(Jaeger))

#### Node Exporter

<img src="https://github.com/MamangRust/monolith-payment-gateway-grpc/raw/main/images/node-exporter.png" alt="hello-node-exporter-grafana-dashboard"/>

#### Email Service

<img src="https://github.com/MamangRust/monolith-payment-gateway-grpc/raw/main/images/email-service.png" alt="hello-email-grafana-dashboard" />


#### Auth Service

<img src="https://github.com/MamangRust/monolith-payment-gateway-grpc/raw/main/images/auth-service.png" alt="hello-auth-grafana-dashboard" />

#### User Service

<img src="https://github.com/MamangRust/monolith-payment-gateway-grpc/raw/main/images/user-service.png" alt="hello-user-grafana-dashboard" />


#### Role Service

<img src="https://github.com/MamangRust/monolith-payment-gateway-grpc/raw/main/images/role-service.png" alt="hello-role-grafana-dashboard" />


#### Merchant Service

<img src="https://github.com/MamangRust/monolith-payment-gateway-grpc/raw/main/images/merchant-service.png" alt="hello-merchant-grafana-dashboard" />

#### Card Service

<img src="https://github.com/MamangRust/monolith-payment-gateway-grpc/raw/main/images/card-service.png" alt="hello-card-grafana-dashboard" />


#### Saldo Service

<img src="https://github.com/MamangRust/monolith-payment-gateway-grpc/raw/main/images/saldo-service.png" alt="hello-saldo-grafana-dashboard" />


#### Topup Service

<img src="https://github.com/MamangRust/monolith-payment-gateway-grpc/raw/main/images/topup-service.png" alt="hello-topup-grafana-dashboard" />


#### Transaction Service

<img src="https://github.com/MamangRust/monolith-payment-gateway-grpc/raw/main/images/transaction-service.png" alt="hello-transaction-grafana-dashboard" />


#### Transfer Service

<img src="https://github.com/MamangRust/monolith-payment-gateway-grpc/raw/main/images/transfer-service.png" alt="hello-transfer-grafana-dashboard" />

#### Withdraw Service

<img src="https://github.com/MamangRust/monolith-payment-gateway-grpc/raw/main/images/withdraw-service.png" alt="hello-withdraw-grafana-dashboard" />


## üîó Source Code & Repository
[üìå View on GitHub](https://github.com/MamangRust/monolith-payment-gateway-grpc)