---
title: "Find Customer Referee"
description: "Introduction to the SQL SELECT statement, including basic queries, filtering data, sorting, and using aggregate functions."
tags: ["SQL", "SELECT", "queries", "database", "filtering", "sorting", "aggregate functions"]
date: "2025-03-03"
published: false
---

## Sql

### Problem Statement

The task is to find the names of customers who are **not referred by the customer with `id = 2`**. The input consists of a table with the following structure:

1. **`id`**: The unique identifier for each customer.
2. **`name`**: The name of the customer.
3. **`referee_id`**: The ID of the customer who referred them, or `NULL` if no one referred them.

### Constraints

- Return only the `name` column for customers who are either:
  - Not referred by the customer with `id = 2`.
  - Not referred by anyone (`referee_id IS NULL`).
- The result order does not matter.

### Example Input

```table
| id | name | referee_id |
|----|------|------------|
| 1  | Will | NULL       |
| 2  | Jane | NULL       |
| 3  | Alex | 2          |
| 4  | Bill | NULL       |
| 5  | Zack | 1          |
| 6  | Mark | 2          |

```

### Example Ouput

```table
| name    |
|---------|
| Will    |
| Jane    |
| Bill    |
```

### Explanation


Only ``Will``, ``Jane``, and ``Bill`` are not referred by anyone since their ```referee_id``` is ```NULL```.

### SQL Implementation

To solve this in SQL, use the ``SELECT`` statement with a ``WHERE`` clause to filter rows based on the condition that ``referee_id`` is not ``2`` or is ``NULL``.

```sql
select name
from customer
where referee_id != 2 or referee_id is NULL;

```

### Explnation

- ``referee_id != 2 `` : Selects customers who are not referred by the customer with id = 2.
- ``OR referee_id IS NULL``: Includes customers who are not referred by anyone (NULL value).
- ``SELECT name``: Retrieves only the name column for the filtered rows.


## NoSQL(MongoDB)

In MongoDB, use the find method with an ``$or`` operator to handle the condition that ``referee_id`` is not ``2`` or is ``null``.

### Example Dataset

```json
[
  { "id": 1, "name": "Will", "referee_id": null },
  { "id": 2, "name": "Jane", "referee_id": null },
  { "id": 3, "name": "Alex", "referee_id": 2 },
  { "id": 4, "name": "Bill", "referee_id": null },
  { "id": 5, "name": "Zack", "referee_id": 1 },
  { "id": 6, "name": "Mark", "referee_id": 2 }
]
```

### MongoDB Query

```js
db.customer.find(
  {
    $or: [
      { referee_id: { $ne: 2 } },
      { referee_id: null }
    ]
  },
  { _id: 0, name: 1 }
);

```

## Explanation
- ```{ referee_id: null }```: Filters documents where the referee_id field is null.
- ``{ _id: 0, name: 1 }``: Projects only the name field in the output, excluding the default _id.

-----