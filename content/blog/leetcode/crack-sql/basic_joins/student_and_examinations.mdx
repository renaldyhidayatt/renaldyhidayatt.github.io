---
title: "Basic Joins in SQL"
description: "Introduction to fundamental SQL joins, including INNER JOIN, LEFT JOIN, RIGHT JOIN, and FULL JOIN, with examples and use cases."
tags: ["SQL", "joins", "INNER JOIN", "LEFT JOIN", "RIGHT JOIN", "FULL JOIN", "database"]
date: "2025-03-03"
published: false
---



## 1280. Students and Examinations

### Problem Statement

The goal is to generate a report that displays the number of times each student attended each exam, including cases where a student did not attend a particular subject exam. The output should include all students and all subjects.

---

### Input Table Structure

#### Students Table

| Column Name   | Type     | Description                                |
|---------------|----------|--------------------------------------------|
| `student_id`  | `int`    | Unique ID for each student.               |
| `student_name`| `varchar`| Name of the student.                      |

- **Primary Key**: `student_id`.

#### Subjects Table

| Column Name   | Type     | Description                                |
|---------------|----------|--------------------------------------------|
| `subject_name`| `varchar`| Unique name of each subject.              |

- **Primary Key**: `subject_name`.

#### Examinations Table

| Column Name   | Type     | Description                                |
|---------------|----------|--------------------------------------------|
| `student_id`  | `int`    | ID of the student who attended the exam.  |
| `subject_name`| `varchar`| Name of the subject for the attended exam.|

- **No Primary Key**: Table may contain duplicates.

---

### Example Input and Output

#### Input Tables

#### Students Table

```table
| student_id | student_name |
|------------|--------------|
| 1          | Alice        |
| 2          | Bob          |
| 13         | John         |
| 6          | Alex         |
```

#### Subjects Table

```table
| subject_name |
|--------------|
| Math         |
| Physics      |
| Programming  |
```

#### Examinations Table

```table
| student_id | subject_name |
|------------|--------------|
| 1          | Math         |
| 1          | Physics      |
| 1          | Programming  |
| 2          | Programming  |
| 1          | Physics      |
| 1          | Math         |
| 13         | Math         |
| 13         | Programming  |
| 13         | Physics      |
| 2          | Math         |
| 1          | Math         |
```

#### Output Table

```table
| student_id | student_name | subject_name | attended_exams |
|------------|--------------|--------------|----------------|
| 1          | Alice        | Math         | 3              |
| 1          | Alice        | Physics      | 2              |
| 1          | Alice        | Programming  | 1              |
| 2          | Bob          | Math         | 1              |
| 2          | Bob          | Physics      | 0              |
| 2          | Bob          | Programming  | 1              |
| 6          | Alex         | Math         | 0              |
| 6          | Alex         | Physics      | 0              |
| 6          | Alex         | Programming  | 0              |
| 13         | John         | Math         | 1              |
| 13         | John         | Physics      | 1              |
| 13         | John         | Programming  | 1              |
```

### SQL Solution

To solve this problem in SQL, use a Cartesian Product to generate all possible combinations of students and subjects, then left join with the Examinations table to count attendance.

### SQL QUERY

```sql
WITH AllCombinations AS (
    SELECT
        s.student_id,
        s.student_name,
        sub.subject_name
    FROM
        Students s
    CROSS JOIN
        Subjects sub
)
SELECT
    ac.student_id,
    ac.student_name,
    ac.subject_name,
    COUNT(e.subject_name) AS attended_exams
FROM
    AllCombinations ac
LEFT JOIN
    Examinations e
ON
    ac.student_id = e.student_id AND ac.subject_name = e.subject_name
GROUP BY
    ac.student_id, ac.student_name, ac.subject_name
ORDER BY
    ac.student_id, ac.subject_name;
```


### Explanation
1. Generate All Combinations:

  - Use CROSS JOIN to create all combinations of students and subjects.

2. Join and Count:

  - Perform a LEFT JOIN with the Examinations table to include attendance records, if any.
  - Use COUNT() to calculate the number of exams attended per combination.

3. Group and Sort:

  - Group by student_id, student_name, and subject_name for accurate counts.
  - Order the results by student_id and subject_name to match the required format.


### MONGODB Impl

In MongoDB, use the aggregation framework to achieve the same result by combining all students and subjects, then computing attendance.


### MongoDB Query

```js

// Step 1: Generate all combinations of students and subjects
const students = db.students.find().toArray();
const subjects = db.subjects.find().toArray();

const combinations = [];
students.forEach(student => {
  subjects.forEach(subject => {
    combinations.push({
      student_id: student.student_id,
      student_name: student.student_name,
      subject_name: subject.subject_name
    });
  });
});

// Step 2: Compute attendance
db.examinations.aggregate([
  {
    $group: {
      _id: { student_id: "$student_id", subject_name: "$subject_name" },
      count: { $sum: 1 }
    }
  },
  {
    $lookup: {
      from: "students",
      localField: "_id.student_id",
      foreignField: "student_id",
      as: "student_info"
    }
  },
  {
    $unwind: "$student_info"
  },
  {
    $project: {
      student_id: "$_id.student_id",
      student_name: "$student_info.student_name",
      subject_name: "$_id.subject_name",
      attended_exams: "$count"
    }
  }
]);
```


## Explanation
1. Generate Combinations:

  - Use JavaScript to create all combinations of students and subjects.

2. Aggregate Attendance:

- Group records in the examinations collection by student_id and subject_name to calculate attendance.

3. Enrich Data:

- Use $lookup to fetch student names from the students collection.

4. Output:

- Format and output the required fields: student_id, student_name, subject_name, and attended_exams.

---------------------------------