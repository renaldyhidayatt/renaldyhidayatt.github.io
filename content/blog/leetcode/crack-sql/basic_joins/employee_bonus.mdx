---
title: "Basic Joins in SQL"
description: "Introduction to fundamental SQL joins, including INNER JOIN, LEFT JOIN, RIGHT JOIN, and FULL JOIN, with examples and use cases."
tags: ["SQL", "joins", "INNER JOIN", "LEFT JOIN", "RIGHT JOIN", "FULL JOIN", "database"]
date: "2025-03-03"
published: false
---





## 577. Employee Bonus

### Problem Statement

The objective is to find the name and bonus amount of employees whose bonus is less than 1000. If an employee is not listed in the `Bonus` table, assume their bonus is `null`.

---

### Input Table Structure

#### Employee Table

| Column Name  | Type    | Description                                |
|--------------|---------|--------------------------------------------|
| `empId`      | `int`   | Unique ID for each employee.              |
| `name`       | `varchar` | Name of the employee.                  |
| `supervisor` | `int`   | ID of the employee's supervisor.           |
| `salary`     | `int`   | Salary of the employee.                   |

- **Primary Key**: `empId`.

#### Bonus Table

| Column Name | Type   | Description                     |
|-------------|--------|---------------------------------|
| `empId`     | `int`  | Unique ID of the employee.     |
| `bonus`     | `int`  | Bonus amount of the employee.  |

- **Primary Key**: `empId`.
- **Foreign Key**: `empId` in the `Bonus` table references `empId` in the `Employee` table.

---

### Example Input and Output

#### Input Tables

**Employee Table**

```table
| empId | name   | supervisor | salary |
|-------|--------|------------|--------|
| 3     | Brad   | null       | 4000   |
| 1     | John   | 3          | 1000   |
| 2     | Dan    | 3          | 2000   |
| 4     | Thomas | 3          | 4000   |
```

#### Bonus Table

```table
| empId | bonus |
|-------|-------|
| 2     | 500   |
| 4     | 2000  |
```

#### Output Table

```table
| name   | bonus |
|--------|-------|
| Brad   | null  |
| John   | null  |
| Dan    | 500   |
```

### SQL Solution
The task can be solved using a LEFT JOIN between the Employee and Bonus tables to include all employees and their corresponding bonuses. Then, filter the results where the bonus is less than 1000 or is null.


### SQL Query

```sql
SELECT
    e.name,
    b.bonus
FROM
    Employee e
LEFT JOIN
    Bonus b
ON
    e.empId = b.empId
WHERE
    b.bonus < 1000 OR b.bonus IS NULL;
```

### Explanation
1. LEFT JOIN:

  - Retrieve all records from the Employee table.
  - Include matching records from the Bonus table, or null if there is no match.

2. Filter Condition:

  - Use WHERE b.bonus < 1000 OR b.bonus IS NULL to filter employees whose bonus is either:
    - Less than 1000, or
    - Not listed in the Bonus table (bonus is null).

### NoSQL(MongoDB)

In MongoDB, we can use the aggregation framework to join the two collections and filter the results based on the bonus condition.

### MongoDB Query

```javascript
db.employee.aggregate([
  {
    $lookup: {
      from: "bonus",
      localField: "empId",
      foreignField: "empId",
      as: "bonus_info"
    }
  },
  {
    $unwind: {
      path: "$bonus_info",
      preserveNullAndEmptyArrays: true
    }
  },
  {
    $project: {
      name: 1,
      bonus: { $ifNull: ["$bonus_info.bonus", null] }
    }
  },
  {
    $match: {
      $or: [{ bonus: { $lt: 1000 } }, { bonus: null }]
    }
  }
]);
```


### Explanation
1. $lookup:

  - Perform a join between the employee collection and the bonus collection using empId.
2. $unwind:

- Flatten the bonus_info array, and retain records with no bonus using preserveNullAndEmptyArrays: true.

3. $project:

- Include the name field and compute the bonus field, defaulting to null if no bonus exists.

4. $match:

- Filter employees whose bonus is either:
  - Less than 1000, or
  - null.

-----------
